{{- $namespaces := list .Release.Namespace .Values.namespaceOverride (dig "spire" "namespaces" "server" "name" "" .Values.global) (dig "spire" "namespaces" "system" "name" "" .Values.global) | compact | uniq }}
{{- include "spire-lib.cluster-spiffe-ids" (dict "controllerManagerEnabled" .Values.controllerManager.enabled "releaseName" .Release.Name "releaseNamespace" .Release.Namespace "crNameOverride" .Values.crNameOverride "className" (include "spire-server.controller-manager-class-name" .) "clusterSPIFFEIDs" .Values.controllerManager.identities.clusterSPIFFEIDs "namespaces" $namespaces) }}
